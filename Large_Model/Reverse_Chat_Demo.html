<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>倒序聊天Demo</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, Helvetica Neue, sans-serif;
            background: #ededed;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* 消息展示区域 */
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #e5e5e5;
        }

        /* 消息气泡通用样式 */
        .message {
            display: block; /* 保持块级元素 */
            width: fit-content; /* 宽度根据内容自适应 */
            max-width: 70%; /* 限制最大宽度 */
            margin: 10px 0; /* 上下间距 */
            padding: 12px 15px;
            border-radius: 8px;
            position: relative;
            word-break: break-word; /* 防止长单词溢出 */
            animation: fadeIn 0.3s ease;
        }

        /* 用户消息样式 */
        .user-message {
            background: #9eea6a;
            margin-left: auto;
            border-top-right-radius: 2px;  
            text-align: left; /* 确保文本左对齐 */
        }

        /* 机器人消息样式 */
        .bot-message {
            background: white;
            margin-right: auto;
            border-top-left-radius: 2px;
            text-align: left;
        }

        /* 输入区域 */
        .input-area {
            display: flex;
            align-items: flex-end; /* 子元素垂直方向对齐到容器底部 */
            padding: 15px;
            border-top: 1px solid #ddd;
            background: white;
            gap: 10px;
        }

        #message-input {
            flex: 1;
            height: 20px;
            max-height: 80px;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            resize: none;
            line-height: 1.5;
            font-size: 16px;
            overflow-y: auto;
        }

        #send-btn {
            align-self: flex-end; /* 确保按钮自身对齐到容器底部 */
            width: 60px;
            height: 40px;
            background: #07c160;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        #send-btn:hover {
            opacity: 0.9;
        }

        /* 加载动画 */
        .typing-indicator {
            display: inline-block;
            padding: 12px 15px;
            background: white;
            border-radius: 8px;
            margin: 5px 0;
        }

        .dot-flashing {
            position: relative;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #999;
            animation: dotFlashing 1s infinite linear;
        }

        .dot-flashing::before,
        .dot-flashing::after {
            content: '';
            display: inline-block;
            position: absolute;
            top: 0;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #999;
        }

        .dot-flashing::before {
            left: -10px;
            animation: dotFlashing 1s infinite linear;
            animation-delay: 0s;
        }

        .dot-flashing::after {
            left: 10px;
            animation: dotFlashing 1s infinite linear;
            animation-delay: 0.2s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes dotFlashing {
            0% { background-color: #999; }
            50%, 100% { background-color: #ddd; }
        }
    </style>
</head>
<body>
    <div class="chat-messages" id="chat-box">
        <!-- 初始欢迎消息 -->
        <div class="message bot-message">你好！我是倒序机器人，你说什么我都会倒过来回复哦~</div>
    </div>
    
    <div class="input-area">
        <textarea id="message-input" placeholder="输入消息..."></textarea>
        <button id="send-btn" onclick="sendMessage()">发送</button>
    </div>

    <script>
        // 添加消息到聊天框
        function addMessage(text, isUser = false) {
            const chatBox = document.getElementById('chat-box');
            
            // 创建消息元素
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            messageDiv.textContent = text;

            // 添加动画效果
            messageDiv.style.opacity = '0';
            chatBox.appendChild(messageDiv);
            
            // 触发动画
            setTimeout(() => {
                messageDiv.style.opacity = '1';
            }, 10);

            // 自动滚动到底部
            chatBox.scrollTo({
                top: chatBox.scrollHeight,
                behavior: 'smooth'
            });
        }

        // 显示正在输入状态
        function showTypingIndicator() {
            const chatBox = document.getElementById('chat-box');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = '<div class="dot-flashing"></div>';
            chatBox.appendChild(typingDiv);
            chatBox.scrollTo({
                top: chatBox.scrollHeight,
                behavior: 'smooth'
            });
            return typingDiv;
        }

        // 发送消息处理
        function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message) return;

            // 添加用户消息
            addMessage(message, true);
            input.value = '';

            // 显示正在输入状态
            const typingIndicator = showTypingIndicator();

            // 模拟AI处理（倒序输出）
            setTimeout(() => {
                // 移除输入状态
                typingIndicator.remove();
                
                // 生成倒序回复
                const reversedText = message.split('').reverse().join('');
                addMessage(reversedText);
            }, 800); // 模拟处理延迟
        }

        // 回车发送功能
        document.getElementById('message-input').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // 输入框高度自适应
        document.getElementById('message-input').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight - 20 + 'px';
        });
    </script>
</body>
</html>